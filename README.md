# cats_keypoint_detection

В данном проекте используется модель mobilenet сеть для детекции точек. В будущем я собираюсь использовать данную сеть в мобильном приложении, поэтому я отчасти скован в выборе архитектуры. Базовыми подходами в решении этой задачи являются heatmap regression и coordinate regression. Первый подход выигрывает в большистве случаев, поскольку мы получим все возможные точки на изображении, coordinate regression позволяет взять более простую архитектуру, которая выдает фиксированное кол-во точек. 

В планах использовать top-down подход, когда мы сначала детектируем все инстансы, после чего подаем в сеть для точек каждый кроп. Mobile-net архитектура выбрана, поскольку она использует оптимизированные depthwise separable convolutions, алгоритмическая сложность которых составляет (height_in * width_in + channels_out) * kernel_width * kernel_height * channels_out, вместо обычных height_in * width_in * channels_out * kernel_width * kernel_height * channels_out. Потеря в качемтве с таким методом гораздно менее большая, нежели полученное ускорение.

В проекте лежит два файла, один из которых нужен для препроцессинга: вместо обычного ресайза к фиксированному размеру с искажением, используется сначада дополнение фото до квадрата, а потом только ресайз.

Также лежит файл с train лупом.

Выбор сделан в пользу tensorflow, полськоку он умеет хороший интерфейс для инференса на мобильных устройствах.

Датасет для обучения: https://www.kaggle.com/crawford/cat-dataset
![Screenshot](index.png)
